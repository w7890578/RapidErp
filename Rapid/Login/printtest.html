<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title></title>
   
<style type="text/css" media="print"> 
.noprint{display : none } 
</style> 
</head>
<body>
    <OBJECT classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2" height=0 id="wb" name="wb" width=0></OBJECT> 
    <input type=button name=button_print value="打印" class="noprint" onclick="javascript: printit()"> 
<input type=button name=button_setup value="打印页面设置" class="noprint" onclick="javascript: printsetup();"> 
<input type=button name=button_show value="打印预览" class="noprint" onclick="javascript: printpreview();"> 
</body>
</html>
 <script type="text/javascript">
     var HKEY_Root, HKEY_Path, HKEY_Key;
     HKEY_Root = "HKEY_CURRENT_USER";
     HKEY_Path = "\\Software\\Microsoft\\Internet Explorer\\PageSetup\\";
     //设置网页打印的页眉页脚为空    
     function PageSetup_Null() {
         try {
             var Wsh = new ActiveXObject("WScript.Shell");
             HKEY_Key = "header";
             Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "");
             HKEY_Key = "footer";
             Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "");
         } catch (e) { }
     }
     //恢复网页打印的页眉页脚   
     function PageSetup_default() {
         try {
             var Wsh = new ActiveXObject("WScript.Shell");
             HKEY_Key = "header";
             Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "&w&b页码,&p/&P");
             HKEY_Key = "footer";
             Wsh.RegWrite(HKEY_Root + HKEY_Path + HKEY_Key, "&u&b&d");
         } catch (e) { }
     }

     function printsetup() {
         // 打印页面设置 
         wb.execwb(8, 1);
     }
     function printpreview() {
         // 打印页面预览 
         PageSetup_Null();
         wb.execwb(7, 1);
         

     }

     function printit() {
         if (confirm('确定打印吗？')) {
             PageSetup_Null();
             wb.execwb(6, 6)
         }
     }

</script>  
